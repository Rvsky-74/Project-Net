import{initializeApp as ie}from"https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";import{getAuth as re,onAuthStateChanged as ae,signOut as ce,GoogleAuthProvider as le,signInWithPopup as de}from"https://www.gstatic.com/firebasejs/11.3.1/firebase-auth.js";import{getFirestore as ue,doc as S,getDoc as B,setDoc as z,collection as me,getDocs as fe,deleteDoc as j,updateDoc as ge}from"https://www.gstatic.com/firebasejs/11.3.1/firebase-firestore.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const c of t)if(c.type==="childList")for(const r of c.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function n(t){const c={};return t.integrity&&(c.integrity=t.integrity),t.referrerPolicy&&(c.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?c.credentials="include":t.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(t){if(t.ep)return;t.ep=!0;const c=n(t);fetch(t.href,c)}})();const i={nodes:[],arrows:[],link_mode_on:!1,simulating:!1,isMouseDown:!1,dragged:!1,clickingNode:null,nodeInitialPosition:{x:0,y:0},_dragOffsetX:0,_dragOffsetY:0,start_coords:[0,0],end_coords:[0,0],box_opened:!1,current_save_file:""},pe={apiKey:"AIzaSyC_QBQdq1WeLVaIQH_084N__VQISVz5rbk",authDomain:"task-manager-82b19.firebaseapp.com",projectId:"task-manager-82b19",storageBucket:"task-manager-82b19.firebasestorage.app",messagingSenderId:"114619358141",appId:"1:114619358141:web:d24dfd48a7be49018010d4"},F=ie(pe),L=re(F),I=ue(F);async function ve(){const e=new le;try{const n=(await de(L,e)).user;console.log("Google Sign-In Success:",n.displayName)}catch(o){console.error("Google Sign-In Error:",o)}}async function he(){try{await ce(L),console.log("User logged out")}catch(e){console.error("Logout Error:",e)}}function _e(){document.getElementById("log"),L.currentUser?he():ve()}async function R(e,o){const n=L.currentUser,s=[];i.nodes.forEach(a=>{const m=(a.connections||[]).map(l=>l.name);s.push({name:a.name,x:a.getBoundingClientRect().left,y:a.getBoundingClientRect().top,state:a.state,connections:m})});const t=S(I,"users",n.uid,"saves",String(e));await z(t,{name:o,node_info:s},{merge:!0});const r=document.getElementById("Canvas_Text");r.innerText="Data Saved"}async function ye(){const e=L.currentUser;if(!e){print("saveUserData was called incorrectly");return}const o=S(I,"users",e.uid),n={firstName:e.displayName||"Unknown",email:e.email,lastLogin:new Date().toISOString()};await z(o,n,{merge:!0})}ae(L,e=>{const o=document.getElementById("log");if(e){console.log("User is logged in:",e),o.innerText="Logout";const n=e.photoURL,s=document.getElementById("profile-pic");s.src=n,console.log(n),s.onerror=function(){s.src="no-user.png"},ye()}else{console.log("No user is logged in"),o.innerText="Login";const n=document.getElementById("profile-pic");n.src="no-user.png",H()}$(1)});async function $(e){const o=L.currentUser,n=document.getElementById("Canvas_Text");try{const s=S(I,"users",o.uid,"saves",String(e)),t=await B(s);if(t.exists()){const r=t.data().node_info||[];H(),r.forEach(a=>{te(a.x,a.y,a.name,a.state)}),r.forEach(a=>{const h=i.nodes.find(m=>m.name===a.name);a.connections.forEach(m=>{const l=i.nodes.find(f=>f.name===m);G(h,l),h.connections.push(l)})}),i.nodes.forEach(a=>N(a,a.state,a.state)),n.innerText=i.current_save_file}else n.innerText="No saved data found"}catch(s){console.error("Error loading user data:",s),n.innerText="Error loading data"}}async function xe(){const e=L.currentUser;if(!e){print("Please login before saving/loading data");return}const o=me(I,"users",e.uid,"saves");return(await fe(o)).docs.map(t=>[t.id,t.data().name])}async function W(e,o){const n=L.currentUser,s=S(I,"users",n.uid,"saves",String(e));if(!(await B(s)).exists()){print("Something went wrong, this file number doesnt exist");return}if(o.length==0){await j(s);let c=parseInt(e,10)+1;for(;;){const r=S(I,"users",n.uid,"saves",String(c)),a=await B(r);if(a.exists()){const h=S(I,"users",n.uid,"saves",String(c-1));await z(h,a.data()),await j(r)}else return;c+=1}}else await ge(s,{name:o})}window.login=_e;const y=document.getElementById("circleCanvas");y.width=window.innerWidth;y.height=window.innerHeight;const x=document.getElementById("canvas-container");let E,A=[y.width/2,y.height/2],be=1;function we(){x.addEventListener("pointerdown",e=>{if(i.link_mode_on)return;const o=e.target.closest(".node");o&&(i.clickingNode=o,o.mass=100,i._dragOffsetX=0,i._dragOffsetY=0,i.nodeInitialPosition={x:o.x,y:o.y})}),x.addEventListener("click",e=>{const o=e.target.closest(".node");if(!o)return;if(e.stopPropagation(),i.link_mode_on){if(E!=o&&!E.connections.includes(o)&&!o.connections.includes(E)){if(J(E,o)){C("That would make a loop impossible to complete");return}E.connections.push(o),G(E,o),N(o,o.state,o.state);return}if(E.connections.includes(o)){const t=i.arrows.find(r=>r.parent==E&&r.child==o);t&&(t.remove(),t.parent&&t.parent.outgoingArrows&&(t.parent.outgoingArrows=t.parent.outgoingArrows.filter(r=>r!==t)),t.child&&t.child.incomingArrows&&(t.child.incomingArrows=t.child.incomingArrows.filter(r=>r!==t)),i.arrows=i.arrows.filter(r=>r!=t));let c=E.connections.indexOf(o);c!==-1&&E.connections.splice(c,1),N(o,o.state,o.state),N(E,E.state,E.state);return}}let n=0;i.clickingNode&&(n=Math.abs(i.clickingNode.x-i.nodeInitialPosition.x)+Math.abs(i.clickingNode.y-i.nodeInitialPosition.y),i.clickingNode.mass=1,i.clickingNode=null),n<3&&!i.box_opened&&!i.link_mode_on&&ke(o)})}we();function G(e,o){const n=document.createElement("div");n.classList.add("arrow",o.state),x.appendChild(n);const s=u("div",n,null,["tip"]),t=document.createElement("div");t.className="line",n.appendChild(t),n.parent=e,n.child=o,n._tip=s,n._line=t,e&&e.dataset&&e.dataset.nodeId&&(n.dataset.parentId=e.dataset.nodeId),o&&o.dataset&&o.dataset.nodeId&&(n.dataset.childId=o.dataset.nodeId),V(n),i.arrows.push(n),n.parent.outgoingArrows||(n.parent.outgoingArrows=[]),n.child.incomingArrows||(n.child.incomingArrows=[]),n.parent.outgoingArrows.push(n),n.child.incomingArrows.push(n)}function Q(e=0,o=0){i.arrows.forEach(n=>{V(n,e,o)})}function V(e,o=0,n=0){const s=e._tip,t=e._line,c={x:e.child.x,y:e.child.y},r={x:e.parent.x,y:e.parent.y},a=c.x-r.x,h=c.y-r.y;let m=Math.atan2(h,a);m<0&&(m+=2*Math.PI);let l=Math.sqrt(a*a+h*h);const f=10.5,g=3,p=c.x+f-(f+3*g)*Math.cos(m),b=c.y+f-(f+3*g)*Math.sin(m);s.style.setProperty("--tx",p+o+"px"),s.style.setProperty("--ty",b+n+"px"),s.style.setProperty("--rotation",m+Math.PI/4+"rad");const _=Math.max(0,l-2*f-4*g)/100,v=r.x+f+(f+g)*Math.cos(m),k=r.y+f+(f+g)*Math.sin(m),d=1,w=d*Math.sin(m),P=-d*Math.cos(m);t.style.setProperty("--tx",v+w+o+"px"),t.style.setProperty("--ty",k+P+n+"px"),t.style.setProperty("--scale",_),t.style.setProperty("--rotation",m+"rad")}function N(e,o,n){e.state=n,e.connections.length==0&&n!="Completed"&&e.classList.replace("undoable","doable"),e.incomingArrows&&e.incomingArrows.forEach(s=>{s.classList.replace(o,n),s.parent.connections.filter(t=>t.state==="Uncompleted"||t.state==="Default").length==0?s.parent.state!="Completed"&&s.parent.classList.replace("undoable","doable"):s.parent.classList.replace("doable","undoable")}),e.state=="Completed"&&e.classList.replace("doable","undoable"),X(e)}function K(e){return e.incomingArrows?e.incomingArrows.map(o=>o.parent):[]}function X(e,o=new Set){o.add(e);const n=K(e).filter(s=>s.state==="Completed"||s.classList.contains("complete-mask")).length!=0;n?e.classList.add("complete-mask"):e.classList.remove("complete-mask"),e.incomingArrows&&e.incomingArrows.forEach(s=>{let t=s._line,c=s._tip;n?(t.classList.add("line-mask"),c.classList.add("tip-mask")):(t.classList.remove("line-mask"),c.classList.remove("tip-mask"))}),e.connections.forEach(s=>{o.has(s)||X(s,o)})}let D="";function Ee(e,o,n,s,t){let c;const r=document.createElement("div");r.className="bar",e.appendChild(r);const a=document.createElement("div");a.className="bar",a.style.transform="rotate(90deg)",e.appendChild(a),[e,o,n,s,t].forEach(m=>{m.addEventListener("mouseenter",()=>{c=setTimeout(()=>{const l=document.createElement("div");l.className="tooltip";const f={addbutton:"New Task",savebutton:"Save Current Project",loadbutton:"Load Saved Project",deletebutton:"Clear Canvas",infobutton:"Instructions / Help"};l.textContent=f[m.id],l.style.position="absolute",l.style.right="110%",l.style.top="50%",l.style.transform="translateY(-50%)",l.style.padding="5px 10px",l.style.background="black",l.style.color="white",l.style.borderRadius="5px",l.style.fontSize="12px",l.style.whiteSpace="nowrap",m.appendChild(l)},500)}),m.addEventListener("mouseleave",()=>{clearTimeout(c);const l=m.querySelector(".tooltip");l&&l.remove()})}),e.addEventListener("click",()=>{if(document.querySelector(".input-box")!=null)return;let l=document.createElement("input");l.className="input-box",l.type="text",l.placeholder="Enter task name...",x.appendChild(l),l.focus(),l.addEventListener("keydown",f=>{if(f.key==="Enter"&&l.value.trim()!=""){if(D=l.value.trim(),l.remove(),!se(D)){let v=function(k){g.style.setProperty("--diameter",_+"px"),g.removeEventListener("transitionend",v)};C("Task already in the project");const g=i.nodes.find(k=>k.name===D),p=y.width/2-g.x,b=y.height/2-g.y;Ce(p,b);const _=parseInt(getComputedStyle(g).getPropertyValue("--diameter").slice(0,-2),10);g.style.setProperty("--diameter",_*1.3+"px"),g.addEventListener("transitionend",v);return}te(null,null,D)}f.key=="Escape"&&l.remove()})}),o.addEventListener("click",()=>{H()}),n.addEventListener("click",()=>{U("save")}),s.addEventListener("click",()=>{U("load")}),t.addEventListener("click",()=>{document.querySelector(".help").style.display="block"})}async function U(e){const o=await xe();if(!o)return;e=="save"?C("Choose where to save the current project"):C("Choose a file to load from");const n=document.querySelector(".save-files-menu");n&&n.remove();const s=u("div",x,null,["save-files-menu"]);if(o.forEach(t=>{const c=t[0],r=t[1],a=u("button",s,null,["save-file"]),h=u("div",a,null,["save-number"]),m=u("div",a,null,["file-name"]);h.textContent=c,m.textContent=r;const l=u("button",a,null,["edit-save-file"]);l.style.maskImage="url(pencil.svg)";let f=!1;l.addEventListener("click",async g=>{if(g.stopPropagation(),f)await W(c,""),s.remove(),U(e);else{f=!0,l.style.maskImage="url(trash.svg)";const p=document.createElement("input");p.type="text",p.value=m.textContent,p.className="file-name",a.replaceChild(p,m),p.focus(),p.addEventListener("keydown",b=>{if(b.key==="Enter"&&p.value.trim()!==""){const _=p.value.trim();m.textContent=_,f=!1,l.style.maskImage="url(pencil.svg)",W(c,_),i.current_save_file=_,C(_),a.replaceChild(m,p)}b.key==="Escape"&&(f=!1,l.style.maskImage="url(pencil.svg)",p.remove())})}}),a.addEventListener("click",function(g){s.remove();const p=u("div",x,null,["confirmation-box"]),b=u("p",p,null,["confirmation-text"]);b.textContent=e=="save"?`Do you want to overwritte
"`+r+'"':"Are you sure? The current net will not be saved automatically";const _=u("div",p,null,["confirmation-text"]),v=u("div",_,null,["option"]);v.textContent="Yes";const k=u("div",_,null,["option"]);k.textContent="No",v.addEventListener("click",function(d){p.remove(),e==="save"?R(c,r):(i.current_save_file=r,$(c),A=[y.width/2,y.height/2])}),k.addEventListener("click",function(d){p.remove()})})}),e=="save"){const t=u("button",s,null,["save-file"]),c=u("div",t,null,["save-number"]),r=u("div",t,null,["file-name"]);c.textContent=o.length+1,r.textContent="New Save File",t.addEventListener("click",()=>{s.remove(),u("input",x,null,["input-box"]);const a=u("input",x,null,["input-box"]);a.type="text",a.placeholder="Enter task name...",a.focus(),a.addEventListener("keydown",h=>{h.key==="Enter"&&a.value.trim()!=""&&(R(o.length+1,a.value.trim()),a.remove()),h.key=="Escape"&&a.remove()})})}if(e=="load"&&o.length==0){const t=u("button",s,null,["save-file","no-hover"]),c=u("div",t,null,["file-name"]);c.textContent="No save files yet"}}function ke(e){i.simulating&&M(),i.box_opened=!0;const[o,n]=[e.x,e.y],s=u("div",x,"box",["box",e.state]);s.style.left=`${o}px`,s.style.top=`${n}px`;const t=u("div",x,"sub-box",["sub-box",e.state]);t.style.left=`${o}px`,t.style.top=`${n}px`,new MutationObserver(_=>{for(const v of _)for(const k of v.removedNodes)k===s&&t.remove()}).observe(x,{childList:!0});const r=u("button",t,null,["button"]),a=u("div",r,null,["icon"]);a.style.maskImage="url(cross.svg)",r.addEventListener("click",_=>{const v=K(e),k=[...e.connections];e.incomingArrows&&e.incomingArrows.forEach(d=>{d.remove(),d.parent&&d.parent.outgoingArrows&&(d.parent.outgoingArrows=d.parent.outgoingArrows.filter(w=>w!==d)),i.arrows=i.arrows.filter(w=>w!==d)}),e.outgoingArrows&&e.outgoingArrows.forEach(d=>{d.remove(),d.child&&d.child.incomingArrows&&(d.child.incomingArrows=d.child.incomingArrows.filter(w=>w!==d)),i.arrows=i.arrows.filter(w=>w!==d)}),i.nodes=i.nodes.filter(d=>d!==e),e.remove(),v.forEach(d=>{const w=d.connections.indexOf(e);d.connections.splice(w,1),d.connections.filter(P=>P.state==="Uncompleted"||P.state==="Default").length==0&&d.state!="Completed"&&d.classList.replace("undoable","doable")}),k.forEach(d=>{X(d)})});const h=u("button",t,null,["button"]),m=u("div",h,null,["icon"]);m.style.maskImage="url(pencil.svg)",h.addEventListener("click",_=>{const v=e.querySelector(".text"),k=v.textContent,d=document.createElement("input");d.type="text",d.value=v.textContent,v.textContent="",d.className="text",v.appendChild(d),d.focus(),d.addEventListener("keydown",function(w){w.key==="Enter"&&(d.value!=""?(v.textContent=d.value,e.name=d.value,d.remove()):C("Please enter a name for the node")),w.key==="Escape"&&(v.textContent=k,d.remove())}),d.addEventListener("blur",function(){d.value!=""&&(v.textContent=d.value,e.name=d.value,d.remove())})});const l=u("div",s,null,["button-text-wrapper"]),f=u("div",l,null,["state-text"]);f.textContent=e.state==="Default"?"Undefined":e.state;const g=u("button",l,null,["rounded-square-btn",e.state]);u("div",g,null,["small-circle"]),g.addEventListener("click",_=>{g.classList.toggle("active");const v=e.state==="Default"||e.state==="Uncompleted"?"Completed":"Uncompleted";s.classList.replace(e.state,v),t.classList.replace(e.state,v),g.classList.replace(e.state,v),e.classList.replace(e.state,v),f.textContent=v,N(e,e.state,v)});const p=u("div",s),b=u("button",p,"b1",["link-button"]);b.textContent="Make Connections",b.addEventListener("click",_=>{i.link_mode_on=!0,E=e,s.remove(),i.box_opened=!1,y.classList.replace("canvas-default","canvas-alt"),C("Select pre-requisites for this task")})}function Le(){y.classList.replace("canvas-alt","canvas-default"),document.getElementById("Canvas_Text").innerText="",i.link_mode_on=!1,i.simulating&&M()}function Ce(e,o){i.nodes.forEach(n=>{n.x+=e,n.y+=o,n.style.setProperty("--tx",n.x),n.style.setProperty("--ty",n.y),n.visualX=n.x,n.visualY=n.y}),A[0]+=e,A[1]+=o,Q()}function J(e,o,n=new Set){if(e===o)return!0;n.add(o);for(let s of o.connections)if(!n.has(s)&&J(e,s,n))return!0;return!1}function Z(e){e.forEach(o=>{let s=o.clientHeight;for(o.style.fontSize=s+"px";(o.scrollHeight>o.clientHeight||o.scrollWidth>o.clientWidth)&&(s--,o.style.fontSize=s+"px",!(s<5)););})}const ee=document.querySelectorAll(".file-name");Z(ee);window.addEventListener("resize",()=>Z(ee));function te(e=null,o=null,n=null,s="Default"){for(;!se(n);)n+="+";const t=document.createElement("div");t.classList.add("node",s,"doable"),t.style.left=0,t.style.top=0,t.x=e??Math.random()*y.width,t.y=o??Math.random()*y.height,t.visualX=0,t.visualY=0,t.connections=[],t.incomingArrows=[],t.outgoingArrows=[],t.name=n,t.movimento=[0,0],t.vx=0,t.vy=0,t.state=s,t.mass=1,x.appendChild(t),i.nodes.push(t);const c=document.createElement("div");return c.className="text",c.textContent=n,t.appendChild(c),t.dataset.nodeId=String(be++),i.simulating||M(),t}let q;function M(){if(i.simulating)i.simulating=!1,cancelAnimationFrame(q);else{i.simulating=!0;const o=()=>{i.clickingNode&&(i.clickingNode.x+=i._dragOffsetX,i.clickingNode.y+=i._dragOffsetY,i._dragOffsetX=0,i._dragOffsetY=0),e(),q=requestAnimationFrame(o)};q=requestAnimationFrame(o)}function e(){for(let r=0;r<i.nodes.length;r++){const a=i.nodes[r];for(let m=0;m<i.nodes.length;m++)if(m!=r){const l=i.nodes[m];let f=Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2);f<1&&(f=1);let g=[(l.x-a.x)/f,(l.y-a.y)/f];if(a.connections.includes(l)){const p=f-100;a.movimento[0]+=g[0]*p*200,a.movimento[1]+=g[1]*p*200,l.movimento[0]-=g[0]*p*200,l.movimento[1]-=g[1]*p*200}else a.movimento[0]-=g[0]*3e6/f**2,a.movimento[1]-=g[1]*3e6/f**2}const h=[A[0]-a.x,A[1]-a.y];a.movimento[0]+=h[0]*2,a.movimento[1]+=h[1]*2}i.nodes.forEach(r=>{r.vx+=r.movimento[0]*.01/r.mass,r.vy+=r.movimento[1]*.01/r.mass,r.vx*=.9,r.vy*=.9,r.x+=r.vx*.01+.5*r.movimento[0]*.01*.01/r.mass,r.y+=r.vy*.01+.5*r.movimento[1]*.01*.01/r.mass}),i.clickingNode||(i.end_coords[0]-i.start_coords[0],i.end_coords[1]-i.start_coords[1]),Ie(),Q(),Y()}}let ne=0,oe=0;function Y(){const e=y.getContext("2d");e.clearRect(0,0,y.width,y.height);function o(n,s){const c="rgba(0,0,0,0.3)";e.beginPath(),e.moveTo(n-3,s),e.lineTo(n+3,s),e.moveTo(n,s-3),e.lineTo(n,s+3),e.strokeStyle=c,e.lineWidth=1,e.stroke()}if(!i.link_mode_on){let s=ne,t=oe;for(;s>20/2;)s-=20;for(;s<-20/2;)s+=20;for(;t>20/2;)t-=20;for(;t<-20/2;)t+=20;for(let c=s;c<=y.width+s;c+=20)for(let r=t;r<=y.height+t;r+=20)o(c,r)}}function Ie(){const e=i.end_coords[0]-i.start_coords[0],o=i.end_coords[1]-i.start_coords[1];i.start_coords=i.end_coords,ne+=e,oe+=o,A[0]+=e,A[1]+=o,i.nodes.forEach(n=>{n.x+=e,n.y+=o;const s=0;(Math.abs(n.x-n.visualX)>s||Math.abs(n.x-n.visualX)>s)&&(n.style.setProperty("--tx",n.x+"px"),n.style.setProperty("--ty",n.y+"px"),n.visualX=n.x,n.visualY=n.y),n.movimento=[0,0]})}function H(){i.nodes.forEach(e=>e.remove()),i.arrows.forEach(e=>e.remove()),i.nodes.length=0,i.arrows.length=0}function se(e){return!i.nodes.find(n=>n.name===e)}function C(e){document.getElementById("Canvas_Text").innerText=e}function u(e,o=x,n=null,s=[]){const t=document.createElement(e);return n&&(t.id=n),s.forEach(c=>t.classList.add(c)),o.appendChild(t),t}function Ae(){let e=null;function o(s){s&&(x.classList.remove("dimmed"),s.classList.remove("hovered"),s.incomingArrows&&s.incomingArrows.forEach(t=>t.classList.remove("highlight")),s.outgoingArrows&&s.outgoingArrows.forEach(t=>t.classList.remove("highlight")),e=null)}function n(s){s&&(x.classList.add("dimmed"),s.classList.add("hovered"),s.incomingArrows&&s.incomingArrows.forEach(t=>t.classList.add("highlight")),s.outgoingArrows&&s.outgoingArrows.forEach(t=>t.classList.add("highlight")),e=s)}x.addEventListener("pointerover",s=>{if(i.clickingNode&&!i.link_mode_on)return;const t=s.target.closest(".node");!t||t===e||n(t)}),x.addEventListener("pointerout",s=>{const t=s.target.closest(".node");if(t&&t===e){const c=s.relatedTarget;(c&&c.closest?c.closest(".node"):null)!==t&&o(t)}})}Ae();const T=document.getElementById("circleCanvas");T.width=window.innerWidth;T.height=window.innerHeight;const Se=document.getElementById("canvas-container");Y();let O=!1;function Ne(){if(O=!O,!O){document.querySelectorAll(".menu-dropdown").forEach(b=>{b.addEventListener("animationend",_=>{b.remove()}),b.classList.remove("animate"),b.classList.add("reverse")});return}const e=u("div",Se,null,["menu-dropdown","animate"]),o=u("button",e,"addbutton",["add-node"]),n=u("button",e,"savebutton",["base"]),s=u("div",n,null,["icon"]);s.style.maskImage="url(save.svg)";const t=u("button",e,"loadbutton",["base"]),c=u("div",t,null,["icon"]);c.style.maskImage="url(load.svg)";const r=u("button",e,"deletebutton",["base"]),a=u("div",r,null,["icon"]);a.style.maskImage="url(trash.svg)";const h=u("button",e,"infobutton",["base"]),m=u("div",h,null,["icon"]);m.style.maskImage="url(question-mark.svg)",m.style.maskSize="90%";const l=5,f=40,g=5,p=l*f+(l-1)*g+2*g;e.style.height=`${p}px`,Ee(o,r,n,t,h)}window.addEventListener("resize",()=>{T.width=window.innerWidth,T.height=window.innerHeight,Y()});let Te;document.addEventListener("click",e=>{i.isMouseDown=!1,clearInterval(Te),i.link_mode_on&&!e.target.closest(".node")&&!e.target.closest(".box")&&!i.dragged&&Le(),document.querySelector(".input-box")&&!(e.target.matches(".add-node, .add-node *")||e.target.matches(".input-box"))&&document.querySelector(".input-box").remove(),document.querySelector(".save-files-menu")&&!(e.target.matches(".save-files-menu, .save-files-menu *")||e.target.matches("#loadbutton, #loadbutton *")||e.target.matches("#savebutton, #savebutton *"))&&document.querySelector(".save-files-menu").remove(),document.querySelector(".confirmation-box")&&!(e.target.matches(".confirmation-box, .confirmation-box *")||e.target.matches(".save-files-menu, .save-files-menu *"))&&document.querySelector(".confirmation-box").remove(),e.target.closest("#box")||(document.querySelectorAll("#box").forEach(n=>n.remove()),i.box_opened=!1,!i.simulating&&!i.link_mode_on&&M()),i.dragged&&(i.start_coords=[0,0],i.end_coords=[0,0],i.dragged=!1),document.getElementById("Canvas_Text").innerText!="Welcome"&&!i.link_mode_on&&C(i.current_save_file),i.clickingNode&&(i.clickingNode.mass=1,i.clickingNode=null)});T.addEventListener("mousedown",function(e){e.button===0&&(i.isMouseDown=!0,i.start_coords=[e.clientX,e.clientY],i.end_coords=[e.clientX,e.clientY])});document.addEventListener("mousemove",function(e){if(!i.clickingNode&&i.isMouseDown&&!i.box_opened){i.end_coords=[e.clientX,e.clientY],i.end_coords[0]-i.start_coords[0],i.end_coords[1]-i.start_coords[1],i.dragged=!0;return}i.clickingNode&&!i.box_opened&&(i._dragOffsetX+=e.movementX,i._dragOffsetY+=e.movementY)});window.menu=Ne;
